<!doctype html><html class="dark light"><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><title>
         2020 Feb
        
    </title><meta content="2020 Feb" property=og:title><meta content="An elegant and understated" property=og:description><meta content="An elegant and understated" name=description><link href=/icon/favicon.png rel=icon type=image/png><link href=https://ashang.github.io/zz/fonts.css rel=stylesheet><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']]}}</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link href=https://ashang.github.io/zz/atom.xml rel=alternate title=atbb type=application/atom+xml><link href=https://ashang.github.io/zz/theme/light.css rel=stylesheet><link href=https://ashang.github.io/zz/theme/dark.css id=darkModeStyle rel=stylesheet><link href=https://ashang.github.io/zz/main.css media=screen rel=stylesheet><body><div class=content><header><div class=main><a href=https://ashang.github.io/zz/>atbb</a><div class=socials><a class=social href=https://github.com/ashang/ rel=me> <img alt=github src=/social_icons/github.svg> </a></div></div><nav><a href=$BASE_URL/search/ style=margin-left:.7em>Search</a><a href=/notes style=margin-left:.7em>/notes</a><a href=/posts style=margin-left:.7em>/posts</a><a href=/gallery style=margin-left:.7em>/gallery</a><a href=/tags style=margin-left:.7em>/tags</a><a href=/projects style=margin-left:.7em>/projects</a> | <a href=javascript:void(0) id=dark-mode-toggle onclick=toggleTheme()> <img id=sun-icon src=/feather/sun.svg style=filter:invert(1)> <img id=moon-icon src=/feather/moon.svg> </a><script src=https://ashang.github.io/zz/js/themetoggle.js></script></nav></header><main><article><div class=title><div class=page-header>2020 Feb<span class=primary-color style=font-size:1.6em>.</span></div><div class=meta>Posted on <time>2020-02-20</time></div></div><h1>Table of Contents</h1><ul><li><a href=https://ashang.github.io/zz/posts/2020-feb/#formats-of-configuration-javascript-and-json>Formats of configuration, Javascript and JSON</a><li><a href=https://ashang.github.io/zz/posts/2020-feb/#routing>Routing</a></ul><section class=body><p>https://github.com/request/request<p>As of Feb 11th 2020, request is fully deprecated. No new changes are expected to land. In fact, none have landed for some time.<p>For more information about why request is deprecated and possible alternatives refer to this issue.<blockquote></blockquote><p>向 Facebook 学习：<ul><li><p>Done is better than perfect.</p><li><p>Move fast and break things.</p><li><p>Stay focused and keep shipping.</p><li><p>Code wins arguments.</p><li><p>**简单：如无必要，勿增实体。**保持简单，追求做一件事情只有一种方法。</p><li><p>**易用：一目了然，容易学习。**无论是 API 还是文档，都希望能具有很强的可读性、自学习性。</p><li><p><strong>合理抽象，最佳实践。</strong></p><li><p><strong>不过度设计，只预留必要的可扩展接口。组件合理解耦。。</strong></p></ul><h2 id=formats-of-configuration-javascript-and-json>Formats of configuration, Javascript and JSON</h2><p>JSON is standard, but Javascript is more flexible.<pre class=language-json data-lang=json style=background:#0f1419;color:#bfbab0><code class=language-json data-lang=json><span>{
</span><span>    </span><span style=color:#c2d94c>"source"</span><span style=color:#bfbab0cc>: </span><span style=color:#c2d94c>"content"</span><span style=color:#bfbab0cc>,
</span><span>    </span><span style=color:#c2d94c>"output"</span><span style=color:#bfbab0cc>: </span><span style=color:#c2d94c>"_site"</span><span style=color:#bfbab0cc>,
</span><span>    </span><span style=color:#c2d94c>"permalink"</span><span style=color:#bfbab0cc>: </span><span style=color:#c2d94c>"{{filename}}.html"</span><span style=color:#bfbab0cc>,
</span><span>    </span><span style=color:#c2d94c>"theme"</span><span style=color:#bfbab0cc>: </span><span style=color:#c2d94c>"_themes/one"</span><span style=color:#bfbab0cc>,
</span><span>    </span><span style=color:#c2d94c>"writers"</span><span style=color:#bfbab0cc>: </span><span>[
</span><span>        </span><span style=color:#c2d94c>"nico.PostWriter"</span><span style=color:#bfbab0cc>,
</span><span>        </span><span style=color:#c2d94c>"nico.StaticWriter"</span><span style=color:#bfbab0cc>,
</span><span>        </span><span style=color:#c2d94c>"nico.FileWriter"
</span><span>    ]
</span><span>}
</span></code></pre><pre class=language-js data-lang=js style=background:#0f1419;color:#bfbab0><code class=language-js data-lang=js><span style=font-style:italic;color:#39bae6>exports</span><span style=color:#f29668>.</span><span>source </span><span style=color:#f29668>= </span><span style=color:#c2d94c>"content"
</span><span style=font-style:italic;color:#39bae6>exports</span><span style=color:#f29668>.</span><span>output </span><span style=color:#f29668>= </span><span style=color:#c2d94c>"_site"
</span><span style=font-style:italic;color:#39bae6>exports</span><span style=color:#f29668>.</span><span>permalink </span><span style=color:#f29668>= </span><span style=color:#c2d94c>"{{filename}}.html"
</span><span>
</span><span style=font-style:italic;color:#5c6773>// you can use node library
</span><span style=color:#ff7733>var </span><span>path </span><span style=color:#f29668>= </span><span style=color:#f07178>require</span><span>(</span><span style=color:#c2d94c>'path'</span><span>)
</span><span style=font-style:italic;color:#39bae6>exports</span><span style=color:#f29668>.</span><span>theme </span><span style=color:#f29668>= </span><span>path</span><span style=color:#f29668>.</span><span style=color:#f07178>join</span><span>(__dirname</span><span style=color:#bfbab0cc>, </span><span style=color:#c2d94c>'one'</span><span>)
</span><span>
</span><span style=font-style:italic;color:#39bae6>exports</span><span style=color:#f29668>.</span><span>writers </span><span style=color:#f29668>= </span><span>[
</span><span>    </span><span style=color:#c2d94c>'nico.PostWriter'</span><span style=color:#bfbab0cc>,
</span><span>    </span><span style=color:#c2d94c>'nico.StaticWriter'</span><span style=color:#bfbab0cc>,
</span><span>    </span><span style=color:#c2d94c>'nico.FileWriter'
</span><span>]
</span></code></pre><pre class=language-json data-lang=json style=background:#0f1419;color:#bfbab0><code class=language-json data-lang=json><span>exports.source = </span><span style=color:#c2d94c>"content"
</span><span>exports.output = </span><span style=color:#c2d94c>"_site"
</span><span>exports.permalink = </span><span style=color:#c2d94c>"{{filename}}.html"
</span><span>
</span><span style=font-style:italic;color:#5c6773>// you can use node library
</span><span>var path = require('path')
</span><span>exports.theme = path.join(__dirname, 'one')
</span><span>
</span><span>exports.writers = [
</span><span>    </span><span style=color:#ff3333>'nico.PostWriter'</span><span style=color:#bfbab0cc>,
</span><span>    </span><span style=color:#ff3333>'nico.StaticWriter'</span><span style=color:#bfbab0cc>,
</span><span>    </span><span style=color:#ff3333>'nico.FileWriter'
</span><span>]
</span></code></pre><pre class=language-js data-lang=js style=background:#0f1419;color:#bfbab0><code class=language-js data-lang=js><span>{
</span><span>    </span><span style=color:#c2d94c>"source"</span><span>: </span><span style=color:#c2d94c>"content"</span><span style=color:#bfbab0cc>,
</span><span>    </span><span style=color:#c2d94c>"output"</span><span>: </span><span style=color:#c2d94c>"_site"</span><span style=color:#bfbab0cc>,
</span><span>    </span><span style=color:#c2d94c>"permalink"</span><span>: </span><span style=color:#c2d94c>"{{filename}}.html"</span><span style=color:#bfbab0cc>,
</span><span>    </span><span style=color:#c2d94c>"theme"</span><span>: </span><span style=color:#c2d94c>"_themes/one"</span><span style=color:#bfbab0cc>,
</span><span>    </span><span style=color:#c2d94c>"writers"</span><span>: [
</span><span>        </span><span style=color:#c2d94c>"nico.PostWriter"</span><span style=color:#bfbab0cc>,
</span><span>        </span><span style=color:#c2d94c>"nico.StaticWriter"</span><span style=color:#bfbab0cc>,
</span><span>        </span><span style=color:#c2d94c>"nico.FileWriter"
</span><span>    ]
</span><span>}
</span></code></pre><h2 id=routing>Routing</h2><p>路由表（routing table）或称路由择域信息库（RIB, Routing Information Base），是一个存储在路由器或者联网计算机中的电子表格（文件）或类数据库。路由表存储着指向特定网络地址的路径（在有些情况下，还记录有路径的路由度量值）。路由表中含有网络周边的拓扑信息。路由表建立的主要目标是为了实现路由协议和静态路由选择。<p>在现代路由器构造中，路由表不直接参与数据包的传输，而是用于生成一个小型指向表，这个指向表仅仅包含由路由算法选择的数据包传输优先路径，这个表格通常为了优化硬件存储和查找而被压缩或提前编译。<p>当代路由构造中将路由表的控制功能和传输表的传输区分开来[1]。<p>主机路由：一个有特定网络地址（网络ID和主机ID）的路由。主机路由允许智能化的路由选择。主机路由通常用于创建用于控制和优化特定网络通信的定制路由。 默认路由：一个当别的路由在路由表中未被找到的时候使用的路由。如果一个路由器或终端系统（如装有Microsoft Windows和Linux的个人电脑），找不到到达目的地的路由时就会使用默认路由。<p>路由表构造的挑战 在路由表构造中使用有限的空间去存储巨量的路径是最主要的挑战。在互联网上，正在使用的地址聚集技术是一种称为无类别域间路由（CIDR）的按位词头匹配的方案。<p>在网络中每个节点都被认为有一个有效的路由表，路由表必须与各种各样的节点和路径环一致。这就是逐跳路由模型的主要问题，几个拥有不一致的路由表的路由可能会导致传输的数据包进入死循环。路由环路在历史上是有灾难性的路由选择，而如今，如何避免路由环路的出现是路由协议的主要设计目标。<p>路由表的内容 对每组网络接口（interface），路由表至少会存有下面的信息：<p>网络ID（Network ID, Network number）：就是目标地址的网络ID。 子网掩码（subnet mask）：用来判断IP所属网络 下一跳地址/接口（Next hop / interface）：就是数据在发送到目标地址的旅途中下一站的地址。其中interface指向next hop（即为下一个route）。一个自治系统（AS, Autonomous system）中的route应该包含区域内所有的子网，而默认网关（Network id: 0.0.0.0, Netmask: 0.0.0.0）指向自治系统的出口。 根据应用和执行的不同，路由表可能含有如下附加信息：<ul><li>花费（Cost）：就是数据发送过程中通过路径所需要的花费。<li>路由的服务质量<li>路由中需要过滤的出/入连接列表</ul><p>$ ip route default via 10.10.50.1 dev eno1 10.10.50.0/24 dev eno1 proto kernel scope link src 10.10.50.50 172.17.0.0/16 dev docker0 proto kernel scope link src 172.17.0.1 linkdown 172.18.0.0/16 dev br-9b99f9d6cd92 proto kernel scope link src 172.18.0.1 linkdown<p>$ route -n Kernel IP routing table Destination Gateway Genmask Flags Metric Ref Use Iface 0.0.0.0 10.10.50.1 0.0.0.0 UG 0 0 0 eno1 10.10.50.0 0.0.0.0 255.255.255.0 U 0 0 0 eno1 172.17.0.0 0.0.0.0 255.255.0.0 U 0 0 0 docker0 172.18.0.0 0.0.0.0 255.255.0.0 U 0 0 0 br-9b99f9d6cd92<p>Difficulties The need to record routes to large numbers of devices using limited storage space represents a major challenge in routing table construction. In the Internet, the currently dominant address aggregation technology is a bitwise prefix matching scheme called Classless Inter-Domain Routing (CIDR). Supernetworks can also be used to help control routing table size.<p>Contents The routing table consists of at least three information fields:<p>network identifier: The destination subnet and netmask metric: The routing metric of the path through which the packet is to be sent. The route will go in the direction of the gateway with the lowest metric. next hop: The next hop, or gateway, is the address of the next station to which the packet is to be sent on the way to its final destination Depending on the application and implementation, it can also contain additional values that refine path selection:<p>quality of service associated with the route. For example, the U flag indicates that an IP route is up. filtering criteria: Access-control lists associated with the route interface: Such as eth0 for the first Ethernet card, eth1 for the second Ethernet card, etc. Shown below is an example of what the table above could look like on a computer connected to the internet via a home router:<p>Example routing table contents Network destination Netmask Gateway Interface Metric 0.0.0.0 0.0.0.0 192.168.0.1 192.168.0.100 10 127.0.0.0 255.0.0.0 127.0.0.1 127.0.0.1 1 192.168.0.0 255.255.255.0 192.168.0.100 192.168.0.100 10 192.168.0.100 255.255.255.255 127.0.0.1 127.0.0.1 10 192.168.0.1 255.255.255.255 192.168.0.100 192.168.0.100 10 The columns Network destination and Netmask together describe the Network identifier as mentioned earlier. For example, destination 192.168.0.0 and netmask 255.255.255.0 can be written as 192.168.0.0/24. The Gateway column contains the same information as the Next hop, i.e. it points to the gateway through which the network can be reached. The Interface indicates what locally available interface is responsible for reaching the gateway. In this example, gateway 192.168.0.1 (the internet router) can be reached through the local network card with address 192.168.0.100. Finally, the Metric indicates the associated cost of using the indicated route. This is useful for determining the efficiency of a certain route from two points in a network. In this example, it is more efficient to communicate with the computer itself through the use of address 127.0.0.1 (called localhost) than it would be through 192.168.0.100 (the IP address of the local network card). Forwarding table Routing tables are generally not used directly for packet forwarding in modern router architectures; instead, they are used to generate the information for a simpler forwarding table. This forwarding table contains only the routes which are chosen by the routing algorithm as preferred routes for packet forwarding. It is often in a compressed or pre-compiled format that is optimized for hardware storage and lookup.<p>This router architecture separates the control plane function of the routing table from the forwarding plane function of the forwarding table.[3] This separation of control and forwarding provides uninterrupted high-performance forwarding.<p>◎ 俾 bǐ<p>〈動〉<p>(1) 使，把 [make]<p>俾爾單厚。——《詩·小雅·天保》<p>俾也可忘。——《詩·邶風·日月》<p>苟入獄，不問罪之有無…俾困苦不堪。——清· 方苞《獄中雜記》<p>又囑學使俾入邑庠。——《聊齋志異·促織》<p>● 儔<p>chóu ㄔㄡˊ<p>伴侶。唐•韓愈《送窮文》：「攜朋挈儔，去故就新。」元•關漢卿《竇娥冤•第一折》：「則被你坑殺人燕侶鶯儔。」 同類、同輩。《文選•曹植•七啟》：「若夫田文無忌之儔，乃上古之俊公子也。」 匹敵、相比。《文選•嵇康•幽憤詩》：「嗟我憤歎，曾莫能儔。」《文選•孔稚珪•北山移文》：「務光何足比，涓子不能儔。」</section></article></main></div>