<!doctype html><html class="dark light"><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><title>
         Using CSS modules with Sass, Webpack and TypeScript
        
    </title><meta content="Using CSS modules with Sass, Webpack and TypeScript" property=og:title><meta content="A brief explanation on how to add CSS modules for the React/TS/Webpack starter" property=og:description><meta content="A brief explanation on how to add CSS modules for the React/TS/Webpack starter" name=description><link href=/icon/favicon.png rel=icon type=image/png><link href=https://ashang.github.io/zz/fonts.css rel=stylesheet><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']]}}</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link href=https://ashang.github.io/zz/atom.xml rel=alternate title=atbb type=application/atom+xml><link href=https://ashang.github.io/zz/theme/light.css rel=stylesheet><link href=https://ashang.github.io/zz/theme/dark.css id=darkModeStyle rel=stylesheet><link href=https://ashang.github.io/zz/main.css media=screen rel=stylesheet><body><div class=content><header><div class=main><a href=https://ashang.github.io/zz/>atbb</a><div class=socials><a class=social href=https://github.com/ashang/ rel=me> <img alt=github src=/social_icons/github.svg> </a></div></div><nav><a href=$BASE_URL/search/ style=margin-left:.7em>Search</a><a href=/notes style=margin-left:.7em>/notes</a><a href=/posts style=margin-left:.7em>/posts</a><a href=/gallery style=margin-left:.7em>/gallery</a><a href=/tags style=margin-left:.7em>/tags</a><a href=/projects style=margin-left:.7em>/projects</a> | <a href=javascript:void(0) id=dark-mode-toggle onclick=toggleTheme()> <img id=sun-icon src=/feather/sun.svg style=filter:invert(1)> <img id=moon-icon src=/feather/moon.svg> </a><script src=https://ashang.github.io/zz/js/themetoggle.js></script></nav></header><main><article><div class=title><div class=page-header>Using CSS modules with Sass, Webpack and TypeScript<span class=primary-color style=font-size:1.6em>.</span></div><div class=meta>Posted on <time>2020-01-24</time></div></div><h1>Table of Contents</h1><ul><li><a href=https://ashang.github.io/zz/posts/using-sass-modules-typescript/#what-are-css-modules>What are CSS modules?</a><li><a href=https://ashang.github.io/zz/posts/using-sass-modules-typescript/#adding-css-module-to-the-webpack-boilerplate>Adding CSS module to the Webpack boilerplate</a><li><a href=https://ashang.github.io/zz/posts/using-sass-modules-typescript/#anything-missing>Anything missing?</a></ul><section class=body><p>A few months ago, I mentioned in my articles about setting up Webpack with TypeScript (<a href=https://ashang.github.io/zz/posts/using-sass-modules-typescript/2019-10-29_react-typescript-webpack-1.md>part 1</a> and <a href=https://ashang.github.io/zz/posts/using-sass-modules-typescript/2019-11-01_react-typescript-webpack-2.md>part 2</a>) that CSS modules would be a nice addition to it. Here we go!<h2 id=what-are-css-modules>What are CSS modules?</h2><p>One common issue for anyone writing CSS is <strong>specificity</strong>. As a site grows, the number of CSS rules and classes grow. This makes it easy to accidentally re-use an existing class name by inadvertence and wonder why your text is now red.<p>CSS modules are pretty simple. Let's start by writing CSS/Sass/Less as you would normally do:<pre class=language-css data-lang=css style=background:#0f1419;color:#bfbab0><code class=language-css data-lang=css><span style=color:#ffb454>.my-class </span><span>{
</span><span>   </span><span style=color:#39bae6>color</span><span style=color:#bfbab0cc>: </span><span style=font-style:italic;color:#f29668>red</span><span style=color:#bfbab0cc>;
</span><span>}
</span><span style=color:#ffb454>.title </span><span>{
</span><span>   </span><span style=color:#39bae6>font-size</span><span style=color:#bfbab0cc>: </span><span style=color:#f29718>2</span><span style=color:#ff7733>rem</span><span style=color:#bfbab0cc>;
</span><span>}
</span></code></pre><p>You can then import the file in your <code>.js</code>/<code>.ts</code> variable (like <code>import styles from "_style.scss";</code>) and access the class names from it: <code>styles.title</code>. Not very impressive but if you look at the source of your HTML page you will notice the class is some random combination of letters and numbers. This is the powerful part of CSS modules: each class gets its own unique name which means that there cannot be specificity issues anymore.<p>There are a few other ways to solve the specificity issues:<ul><li>use something like <a href=http://getbem.com/>BEM</a>, which requires discipline<li>use a CSS-in-JS library like <a href=https://emotion.sh/docs/introduction>emotion</a>, which is more complex and has lower performance than alternatives<li>hope for the best</ul><h2 id=adding-css-module-to-the-webpack-boilerplate>Adding CSS module to the Webpack boilerplate</h2><p>Turns out enabling them is really easy! The only tricky part is, as some might have guessed from the example above, ensuring TypeScript does not error when loading the Sass file. Thankfully, a loader exists to automatically create definition file from CSS files: <a href=https://www.npmjs.com/package/@teamsupercell/typings-for-css-modules-loader>typings-for-css-modules-loader</a>.<p>Let's go quickly through the main changes needed to the Webpack configuration:<pre class=language-diff data-lang=diff style=background:#0f1419;color:#bfbab0><code class=language-diff data-lang=diff><span style=color:#f07178>-          // Translates CSS into CommonJS
</span><span style=color:#f07178>-          "css-loader",
</span><span style=color:#c2d94c>+          {
</span><span style=color:#c2d94c>+            loader: "@teamsupercell/typings-for-css-modules-loader",
</span><span style=color:#c2d94c>+            options: {
</span><span style=color:#c2d94c>+              banner: "// autogenerated by typings-for-css-modules-loader."
</span><span style=color:#c2d94c>+            }
</span><span style=color:#c2d94c>+          },
</span><span style=color:#c2d94c>+          // Translates CSS into CommonJS with modules
</span><span style=color:#c2d94c>+          {
</span><span style=color:#c2d94c>+            loader: "css-loader",
</span><span style=color:#c2d94c>+            options: {
</span><span style=color:#c2d94c>+              modules: {
</span><span style=color:#c2d94c>+                mode: "local",
</span><span style=color:#c2d94c>+                localIdentName: '[local]--[hash:base64:6]',
</span><span style=color:#c2d94c>+              },
</span><span style=color:#c2d94c>+              localsConvention: "camelCase"
</span><span style=color:#c2d94c>+            }
</span><span style=color:#c2d94c>+          },
</span><span>
</span></code></pre><p>We go from a plain <code>css-loader</code> to one with modules enabled with a <code>local</code> scope and where the generated classes are still readable. We also tell the loader to camel case the classes in order to satisfy the various linters. Lastly, we set the <code>@teamsupercell/typings-for-css-modules-loader</code> <strong>above</strong> the <code>css-loader</code>, the position is important. There are other changes in the commit, such as ignoring all generated files, that are pretty straightforward.<p>The commit is <a href=https://github.com/Keats/webpack-react-typescript/commit/9786130bf283d47af1d1945ac66679a0529254c4>https://github.com/Keats/webpack-react-typescript/commit/9786130bf283d47af1d1945ac66679a0529254c4</a>.<h2 id=anything-missing>Anything missing?</h2><p>Now that we have CSS modules in place, the only thing I consider missing is <a href=https://storybook.js.org/>Storybook</a>. This is unlikely to get an article as it is pretty easy to follow the instructions to install it though.<p>Are there any amazing libraries/Webpack plugins I'm missing out on?</section></article></main></div>