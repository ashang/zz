<!doctype html><html class="dark light"><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><title>
         Gutenberg 0.4.0: custom taxonomies, image processing and more
        
    </title><meta content="Gutenberg 0.4.0: custom taxonomies, image processing and more" property=og:title><meta content="Gutenberg 0.4.0 is out with custom taxonomies, image processing, improved shortcodes and more" property=og:description><meta content="Gutenberg 0.4.0 is out with custom taxonomies, image processing, improved shortcodes and more" name=description><link href=/icon/favicon.png rel=icon type=image/png><link href=https://ashang.github.io/zz/fonts.css rel=stylesheet><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']]}}</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link href=https://ashang.github.io/zz/atom.xml rel=alternate title=atbb type=application/atom+xml><link href=https://ashang.github.io/zz/theme/light.css rel=stylesheet><link href=https://ashang.github.io/zz/theme/dark.css id=darkModeStyle rel=stylesheet><link href=https://ashang.github.io/zz/main.css media=screen rel=stylesheet><body><div class=content><header><div class=main><a href=https://ashang.github.io/zz/>atbb</a><div class=socials><a class=social href=https://github.com/ashang/ rel=me> <img alt=github src=/social_icons/github.svg> </a></div></div><nav><a href=$BASE_URL/search/ style=margin-left:.7em>Search</a><a href=/notes style=margin-left:.7em>/notes</a><a href=/posts style=margin-left:.7em>/posts</a><a href=/gallery style=margin-left:.7em>/gallery</a><a href=/tags style=margin-left:.7em>/tags</a><a href=/projects style=margin-left:.7em>/projects</a> | <a href=javascript:void(0) id=dark-mode-toggle onclick=toggleTheme()> <img id=sun-icon src=/feather/sun.svg style=filter:invert(1)> <img id=moon-icon src=/feather/moon.svg> </a><script src=https://ashang.github.io/zz/js/themetoggle.js></script></nav></header><main><article><div class=title><div class=page-header>Gutenberg 0.4.0: custom taxonomies, image processing and more<span class=primary-color style=font-size:1.6em>.</span></div><div class=meta>Posted on <time>2018-08-04</time></div></div><h1>Table of Contents</h1><ul><li><a href=https://ashang.github.io/zz/posts/releasing-gutenberg-040/#what-s-new>What's new</a> <ul><li><a href=https://ashang.github.io/zz/posts/releasing-gutenberg-040/#breaking-custom-taxonomies>Breaking: custom taxonomies</a></li><ul><li><a href=https://ashang.github.io/zz/posts/releasing-gutenberg-040/#updating-the-configuration>Updating the configuration</a><li><a href=https://ashang.github.io/zz/posts/releasing-gutenberg-040/#updating-the-templates>Updating the templates</a><li><a href=https://ashang.github.io/zz/posts/releasing-gutenberg-040/#updating-the-content>Updating the content</a></ul><li><a href=https://ashang.github.io/zz/posts/releasing-gutenberg-040/#breaking-removal-of-order-sorting-renaming-of-next-previous>Breaking: removal of order sorting & renaming of next/previous</a><li><a href=https://ashang.github.io/zz/posts/releasing-gutenberg-040/#image-processing>Image processing</a><li><a href=https://ashang.github.io/zz/posts/releasing-gutenberg-040/#shortcodes-fixes>Shortcodes fixes</a><li><a href=https://ashang.github.io/zz/posts/releasing-gutenberg-040/#external-link-checker>External link checker</a></ul><li><a href=https://ashang.github.io/zz/posts/releasing-gutenberg-040/#what-s-next>What's next</a></ul><section class=body><p><a href=https://github.com/Keats/gutenberg>Gutenberg</a> is a powerful static site engine inspired by <a href=https://gohugo.io/>Hugo</a> but simpler to use. You can build pretty much any kind of static site with it using markdown:<ul><li>a basic blog<li>a landing site<li>a knowledge base<li>a gitbook (there is a <a href=https://github.com/Keats/book>theme</a> for that)<li>a documentation site<li>all of the above combined</ul><p>You can download built binaries from the <a href=https://github.com/Keats/gutenberg/releases>Github releases page</a> or install it from <a href=https://www.getzola.org/documentation/getting-started/installation/>one of the installation methods</a>.<p>You should also be able to install it on Ubuntu via Snapcraft once <a href=https://forum.snapcraft.io/t/the-rust-plugin-sets-an-invalid-manifest-path/6565/6>this bug</a> is resolved.<h2 id=what-s-new>What's new</h2><p>Lots of things! You can view the <a href=https://github.com/Keats/gutenberg/blob/master/CHANGELOG.md>CHANGELOG</a> for a quick overview: I will look at the biggest changes in more details here including the breaking ones and how to migrate.<h3 id=breaking-custom-taxonomies>Breaking: custom taxonomies</h3><p>Taxonomies are a way to group content together, the most common one in blogs being tags and categories. Before 0.4.0, you could only have those two taxonomies: <code>tags</code> and <code>categories</code>. You couldn't paginate their pages, have a RSS feed for each or create your own taxonomy.<p>Let's see how to use, and also how to migrate from the point of view of a current user already using tags/categories.<p>If you are looking for more information, the <a href=https://www.getzola.org/documentation/content/taxonomies/>docs</a> have been updated — look for the various taxonomies pages in the side menu.<h4 id=updating-the-configuration>Updating the configuration</h4><p>The first thing to do is open your <code>config.toml</code> and list the taxonomies you want to use:<pre class=language-toml data-lang=toml style=background:#0f1419;color:#bfbab0><code class=language-toml data-lang=toml><span style=font-style:italic;color:#5c6773># You can delete those 2 lines, they aren't used anymore.
</span><span style=color:#59c2ff>generate_tags_pages </span><span>= </span><span style=color:#f29718>true
</span><span style=color:#59c2ff>generate_categories_pages </span><span>= </span><span style=color:#f29718>true
</span><span>
</span><span style=font-style:italic;color:#5c6773># And define them like so instead
</span><span style=color:#59c2ff>taxonomies </span><span>= [
</span><span>    </span><span style=font-style:italic;color:#5c6773># each tag will have its own RSS feed
</span><span>    {</span><span style=color:#59c2ff>name </span><span>= </span><span style=color:#c2d94c>"tags"</span><span style=color:#bfbab0cc>, </span><span style=color:#59c2ff>rss </span><span>= </span><span style=color:#f29718>true</span><span>}</span><span style=color:#bfbab0cc>,
</span><span>    </span><span style=font-style:italic;color:#5c6773># 5 items per page for a term, you can also customise the pagination path
</span><span>    </span><span style=font-style:italic;color:#5c6773># like for the rest of the paginated content
</span><span>    {</span><span style=color:#59c2ff>name </span><span>= </span><span style=color:#c2d94c>"categories"</span><span style=color:#bfbab0cc>, </span><span style=color:#59c2ff>paginate_by </span><span>= </span><span style=color:#f29718>5</span><span>}</span><span style=color:#bfbab0cc>,
</span><span>    </span><span style=font-style:italic;color:#5c6773># Basic definition: no RSS or pagination
</span><span>    {</span><span style=color:#59c2ff>name </span><span>= </span><span style=color:#c2d94c>"authors"</span><span>}</span><span style=color:#bfbab0cc>,
</span><span>]
</span></code></pre><h4 id=updating-the-templates>Updating the templates</h4><p>We need to change two things regarding the taxonomies templates:<ul><li>their location<li>the main variable they use</ul><p>First we need to move the templates their new location:<ul><li><code>tags.html</code> -> <code>tags/list.html</code><li><code>tag.html</code> -> <code>tags/single.html</code><li><code>categories.html</code> -> <code>categories/list.html</code><li><code>category.html</code> -> <code>categories/single.html</code></ul><p>In short, Gutenberg is now looking for:<ul><li><code>$TAXONOMY_NAME/single.html</code><li><code>$TAXONOMY_NAME/list.html</code></ul><p>Lastly, the name of the variables available have changed:<ul><li>replace <code>tags</code> and <code>categories</code> with <code>terms</code><li>replace <code>tag</code> and <code>category</code> with <code>term</code></ul><h4 id=updating-the-content>Updating the content</h4><p>Before, your front-matter would look like:<pre style=background:#0f1419;color:#bfbab0><code><span>+++
</span><span>title = "Provisioning and deploying this blog with Ansible"
</span><span>description = "Showing off Ansible by example"
</span><span>date = 2013-08-17
</span><span>category = "Devops"
</span><span>tags = ["ansible"]
</span><span>+++
</span></code></pre><p>An updated version is:<pre style=background:#0f1419;color:#bfbab0><code><span>+++
</span><span>title = "Provisioning and deploying this blog with Ansible"
</span><span>description = "Showing off Ansible by example"
</span><span>date = 2013-08-17
</span><span>
</span><span>[taxonomies]
</span><span>categories = ["Devops"]
</span><span>tags = ["ansible"]
</span><span>+++
</span></code></pre><p>Note that every taxonomies is now required to take an array of string, whereas before there could be only a single category.<h3 id=breaking-removal-of-order-sorting-renaming-of-next-previous>Breaking: removal of <code>order</code> sorting & renaming of <code>next</code>/<code>previous</code></h3><p>Before 0.4.0, you could sort pages by <code>date</code>, <code>order</code> and <code>weight</code>.<p><code>order</code> and <code>weight</code> were the opposite of each other but the difference of meaning led to <a href=https://github.com/Keats/gutenberg/issues/338>confusion</a> when trying to get the <code>previous</code> or the <code>next</code> page.<p>To make things more explicit two changes have been made:<ul><li><code>order</code> has been removed<li><code>page.previous</code> and <code>page.next</code> have been renamed depending on the sorting used: <ul><li><code>date</code>: now called <code>page.earlier</code> and <code>page.later</code><li><code>weight</code>: now called <code>page.lighter</code> and <code>page.heavier</code></ul></ul><p>No more <code>&LTa class="previous" href="{{page.next.permalink}}>{{page.next.title}}&LT/a></code>!<p>To fix sites using <code>order</code> or <code>date</code>, you will need to:<ul><li>change <code>sort_by</code> of the sections to use <code>weight</code><li>rename <code>order</code> to <code>weight</code> and invert the order of values if necessary<li>rename <code>next</code> and <code>previous</code> to <code>heavier</code>/<code>lighter</code> or <code>later</code>/<code>earlier</code></ul><p>This has been implemented by <a href=https://github.com/codesections>Daniel Sockwell</a> as his first ever Rust PR! Daniel has also made tons of improvements to the documentation, something always appreciated.<h3 id=image-processing>Image processing</h3><p>This is the amazing work of <a href=https://github.com/vojtechkral>Vojtech Kral</a> who also wrote a thorough <a href=https://www.getzola.org/documentation/content/image-processing/>documentation page</a> explaining it in detail.<p>In short: you can now resize images from a template and implementing a gallery is trivial. Open an issue if you have an idea for some image processing not already in!<h3 id=shortcodes-fixes>Shortcodes fixes</h3><p>In the previous versions, <a href=https://www.getzola.org/documentation/content/shortcodes/>shortcodes</a> were detected with a Regex and built up while parsing the Markdown which ended up being some of the worst spaghetti code I have ever written. It lead to numerous bugs as well some valuable features like array arguments to be almost impossible to implement — at least for me.<p>In Gutenberg 0.4.0, shortcodes are now rendered before Markdown as a separate pass, going through a custom parser specifically written for it. The rendered shortcodes are then inserted back into the Markdown as raw HTML so the (much simplified) Markdown parser can ignore them. Thanks to that redesign, all shortcodes feature requests were added easily and every known bug has been fixed.<h3 id=external-link-checker>External link checker</h3><p>Link rot can be a big issue: some pages might not make sense anymore as a whole if an important link stopped working.<p>Since Gutenberg already checks internal links, only external links were left to check! Simply add <code>check_external_links = true</code> to your <code>config.toml</code> and Gutenberg will look up every link in your pages, reporting the ones not working.<p>This process is quite slow though so I would recommend enabling it once in a while to check but not all the time. Keep in mind that some results might be false negatives: crates.io for example <a href=https://github.com/rust-lang/crates.io/issues/788>always returns a 404</a>.<h2 id=what-s-next>What's next</h2><p>The main goal for the next version is i18n support. There is an <a href=https://github.com/Keats/gutenberg/pull/111>open RFC</a> to discuss how the implementation would look like, comments are very welcome.<p>The main issue left seems to be the translation of the template texts as I'm not sure how to handle that. Right now it's a dictionary in <code>config.toml</code> but that can grow to be quite large so a separate file for each language would make sense. Pluralization also becomes an issue.<p>Once the spec is clearly defined on all points, I would happy to mentor people of any skill level on bits of it: <code>gutenberg</code> is divided in many sub-crates, making changes pretty self-contained.<p>As always if you have any feedback or bugs, please open an issue. Hopefully soon Gutenberg will have enough users to qualify for a free open-source Discourse forum to have a good way to interact with users more efficiently than GitHub issues. If you are using Gutenberg and are not featured in <a href=https://github.com/Keats/gutenberg/blob/master/EXAMPLES.md>the list of sites</a>, please add yourself!</section></article></main></div>