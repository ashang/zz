<!doctype html><html class="dark light"><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><title>
         Releasing Tera 0.6 and thoughts on a validation crate
        
    </title><meta content="Releasing Tera 0.6 and thoughts on a validation crate" property=og:title><meta content="Releasing Tera 0.6 and thoughts on a validation crate" property=og:description><meta content="Releasing Tera 0.6 and thoughts on a validation crate" name=description><link href=/icon/favicon.png rel=icon type=image/png><link href=https://ashang.github.io/zz/fonts.css rel=stylesheet><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']]}}</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link href=https://ashang.github.io/zz/atom.xml rel=alternate title=atbb type=application/atom+xml><link href=https://ashang.github.io/zz/theme/light.css rel=stylesheet><link href=https://ashang.github.io/zz/theme/dark.css id=darkModeStyle rel=stylesheet><link href=https://ashang.github.io/zz/main.css media=screen rel=stylesheet><body><div class=content><header><div class=main><a href=https://ashang.github.io/zz/>atbb</a><div class=socials><a class=social href=https://github.com/ashang/ rel=me> <img alt=github src=/social_icons/github.svg> </a></div></div><nav><a href=$BASE_URL/search/ style=margin-left:.7em>Search</a><a href=/notes style=margin-left:.7em>/notes</a><a href=/posts style=margin-left:.7em>/posts</a><a href=/gallery style=margin-left:.7em>/gallery</a><a href=/tags style=margin-left:.7em>/tags</a><a href=/projects style=margin-left:.7em>/projects</a> | <a href=javascript:void(0) id=dark-mode-toggle onclick=toggleTheme()> <img id=sun-icon src=/feather/sun.svg style=filter:invert(1)> <img id=moon-icon src=/feather/moon.svg> </a><script src=https://ashang.github.io/zz/js/themetoggle.js></script></nav></header><main><article><div class=title><div class=page-header>Releasing Tera 0.6 and thoughts on a validation crate<span class=primary-color style=font-size:1.6em>.</span></div><div class=meta>Posted on <time>2016-12-26</time></div></div><h1>Table of Contents</h1><ul><li><a href=https://ashang.github.io/zz/posts/releasing-tera-0-6/#breaking-changes>BREAKING CHANGES</a><li><a href=https://ashang.github.io/zz/posts/releasing-tera-0-6/#others>Others</a><li><a href=https://ashang.github.io/zz/posts/releasing-tera-0-6/#validation-crate>Validation crate</a></ul><section class=body><p><a href=https://github.com/Keats/tera>Tera</a> 0.6 has been released on <a href=https://crates.io/>crates.io</a>!<p>I will let the changelog speaks for itself:<h4 id=breaking-changes>BREAKING CHANGES</h4><ul><li><code>not</code> is now a Tera keyword</ul><h4 id=others>Others</h4><ul><li>Added <code>#![deny(missing_docs)]</code> to the crate<li>Added <code>Tera::one_off</code> to parse and render a single template<li>Added <code>not</code> operator in conditions to mean falsiness (equivalent to <code>!</code> in Rust)<li>Remove specific error message when using <code>||</code> or <code>&&</code><li>Improved performances for parsing and rendering (~5-20%)<li>Added <code>precision</code> arg to <code>round</code> filter<li>Added <code>date</code> filter to format a timestamp to a date(time) string</ul><p>Nothing too exciting in that release except finally handling <code>not</code> in expressions.<p>I don't foresee big changes in the API coming soon anymore as we approach feature completeness from my point of view.<p>The 2 main things still lacking are:<ul><li><strong>custom tags</strong>: we would need to expose the renderer or the AST somehow<li><strong>i18n</strong>: no mature i18n libraries in Rust as far as I'm aware</ul><p>I am not using any of those in my own projects but anyone wanting to discuss them is welcome.<h2 id=validation-crate>Validation crate</h2><p>I've been working through the <code>requirements.txt</code> of Proppy to decide what crate to work on in Rust.<p>The next one will probably be a crate similar to the <a href=https://marshmallow.readthedocs.io/en/latest/index.html>marshmallow</a> library. Since Serde can handle the serialization/deserialization aspect already, it will focus only on actual validation with an API looking like that:<pre class=language-rust data-lang=rust style=background:#0f1419;color:#bfbab0><code class=language-rust data-lang=rust><span style=color:#bfbab0cc>#</span><span>[</span><span style=color:#ffb454>derive</span><span>(Debug</span><span style=color:#bfbab0cc>,</span><span> Deserialize</span><span style=color:#bfbab0cc>,</span><span> Validate)]
</span><span style=color:#ff7733>struct </span><span style=color:#59c2ff>SignupData </span><span>{
</span><span>    </span><span style=color:#bfbab0cc>#</span><span>[</span><span style=color:#ffb454>validate</span><span>(email)]
</span><span>    email</span><span style=color:#bfbab0cc>:</span><span> String,
</span><span>    </span><span style=color:#bfbab0cc>#</span><span>[</span><span style=color:#ffb454>validate</span><span>(url)]
</span><span>    site</span><span style=color:#bfbab0cc>:</span><span> String,
</span><span>    </span><span style=color:#bfbab0cc>#</span><span>[</span><span style=color:#ffb454>validate</span><span>(custom</span><span style=color:#f29668>=</span><span style=color:#c2d94c>"validate_unique_username"</span><span>)]
</span><span>    </span><span style=color:#bfbab0cc>#</span><span>[</span><span style=color:#ffb454>validate</span><span>(</span><span style=color:#ffb454>length</span><span>(min</span><span style=color:#f29668>=</span><span>2))]
</span><span>    username</span><span style=color:#bfbab0cc>:</span><span> String,
</span><span>    </span><span style=color:#bfbab0cc>#</span><span>[</span><span style=color:#ffb454>validate</span><span>(</span><span style=color:#ffb454>length</span><span>(min</span><span style=color:#f29668>=</span><span>8</span><span style=color:#bfbab0cc>,</span><span> max</span><span style=color:#f29668>=</span><span>255)</span><span style=color:#bfbab0cc>,</span><span> custom</span><span style=color:#f29668>=</span><span style=color:#c2d94c>"validate_common_passwords"</span><span>)]
</span><span>    password</span><span style=color:#bfbab0cc>:</span><span> String,
</span><span>}
</span></code></pre><p>A non-goal of that crate will be error messages as it's always a pain to handle. Errors will be referenced by a keyword and it will be up to the frontend or the backend to write error messages in the correct format for that application.<p>The first step is figuring out how macros 1.1 work but once it's done, it seems like it will be a fairly small crate.<p>See you in 2017!</section></article></main></div>