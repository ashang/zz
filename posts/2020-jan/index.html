<!doctype html><html class="dark light"><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><title>
         2020 Jan
        
    </title><meta content="2020 Jan" property=og:title><meta content="An elegant and understated" property=og:description><meta content="An elegant and understated" name=description><link href=/icon/favicon.png rel=icon type=image/png><link href=https://ashang.github.io/zz/fonts.css rel=stylesheet><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']]}}</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link href=https://ashang.github.io/zz/atom.xml rel=alternate title=atbb type=application/atom+xml><link href=https://ashang.github.io/zz/theme/light.css rel=stylesheet><link href=https://ashang.github.io/zz/theme/dark.css id=darkModeStyle rel=stylesheet><link href=https://ashang.github.io/zz/main.css media=screen rel=stylesheet><body><div class=content><header><div class=main><a href=https://ashang.github.io/zz/>atbb</a><div class=socials><a class=social href=https://github.com/ashang/ rel=me> <img alt=github src=/social_icons/github.svg> </a></div></div><nav><a href=$BASE_URL/search/ style=margin-left:.7em>Search</a><a href=/notes style=margin-left:.7em>/notes</a><a href=/posts style=margin-left:.7em>/posts</a><a href=/gallery style=margin-left:.7em>/gallery</a><a href=/tags style=margin-left:.7em>/tags</a><a href=/projects style=margin-left:.7em>/projects</a> | <a href=javascript:void(0) id=dark-mode-toggle onclick=toggleTheme()> <img id=sun-icon src=/feather/sun.svg style=filter:invert(1)> <img id=moon-icon src=/feather/moon.svg> </a><script src=https://ashang.github.io/zz/js/themetoggle.js></script></nav></header><main><article><div class=title><div class=page-header>2020 Jan<span class=primary-color style=font-size:1.6em>.</span></div><div class=meta>Posted on <time>2020-01-20</time></div></div><h1>Table of Contents</h1><ul><li><a href=https://ashang.github.io/zz/posts/2020-jan/#breed>Breed</a><li><a href=https://ashang.github.io/zz/posts/2020-jan/#xiu-ding-hao-r1416-gitti-jiao-ji-lu-46ae2a1>修订号 r1416，git提交记录 46ae2a1 ??</a><li><a href=https://ashang.github.io/zz/posts/2020-jan/#openwrt-to-debian-on-atheros-router>OpenWrt to Debian on Atheros router</a><li><a href=https://ashang.github.io/zz/posts/2020-jan/#she-ding-ben-ci-bian-yi-wei-jiao-cha-bian-yi-build-profiles-ju-ti-nei-rong-qing-can-kao-debian-readme-source>设定本次编译为交叉编译（Build profiles 具体内容请参考 debian/README.source）</a><li><a href=https://ashang.github.io/zz/posts/2020-jan/#kai-qi-bing-xing-bian-yi>开启并行编译</a><li><a href=https://ashang.github.io/zz/posts/2020-jan/#jin-zhi-bian-yi-dbg-ruan-jian-bao>禁止编译 -dbg 软件包</a><li><a href=https://ashang.github.io/zz/posts/2020-jan/#qing-li-shang-ci-bian-yi-de-zhong-jian-wen-jian>清理上次编译的中间文件</a><li><a href=https://ashang.github.io/zz/posts/2020-jan/#zhe-li-zhi-xing-hou-hui-ti-shi-cuo-wu-hu-lue-ji-ke>这里执行后会提示错误，忽略即可</a><li><a href=https://ashang.github.io/zz/posts/2020-jan/#jie-bao-yuan-shi-yuan-dai-ma-xu-jiang-linux-4-19-67-orig-tar-xz-fang-dao-shang-ji-mu-lu-yu-linux-4-19-67-ping-ji>解包原始源代码，需将 linux_4.19.67.orig.tar.xz 放到上级目录 (与 linux_4.19.67 平级)</a><li><a href=https://ashang.github.io/zz/posts/2020-jan/#zhe-yi-bu-bu-neng-sheng-lue-yin-wei-debian-yao-bao-zheng-mei-ci-du-shi-shi-yong-xiang-tong-de-gan-jing-de-dai-ma-ji-zhi-da-shang-liao-debian-patches-li-de-patch-wen-jian-jin-xing-bian-yi>这一步不能省略，因为 Debian 要保证每次都是使用相同的干净的代码（即只打上了 debian/patches 里的 patch 文件）进行编译</a><li><a href=https://ashang.github.io/zz/posts/2020-jan/#zhun-bei-yuan-dai-ma-da-patch-sheng-cheng-control-wen-jian-sheng-cheng-bian-yi-gui-ze-deng>准备源代码（打 patch，生成 control 文件，生成编译规则等）</a><li><a href=https://ashang.github.io/zz/posts/2020-jan/#sheng-cheng-config-deng-pei-zhi-wen-jian>生成 .config 等配置文件</a><li><a href=https://ashang.github.io/zz/posts/2020-jan/#bian-yi>编译</a><li><a href=https://ashang.github.io/zz/posts/2020-jan/#she-zhi-language-c-utf-8-shi-wei-liao-bi-mian-zai-fei-ying-wen-xi-tong-li-bian-yi-chu-xian-cuo-wu>设置 LANGUAGE=C.UTF-8 是为了避免在非英文系统里编译出现错误</a><li><a href=https://ashang.github.io/zz/posts/2020-jan/#sheng-cheng-linux-headers-common-deng-bao>生成 linux-headers-common 等包</a> <ul><li><a href=https://ashang.github.io/zz/posts/2020-jan/#></a><li><a href=https://ashang.github.io/zz/posts/2020-jan/#fan-zha>Fan Zha</a></ul><li><a href=https://ashang.github.io/zz/posts/2020-jan/#sudo-apt-get-install-expect-dev>sudo apt-get install expect-dev</a><li><a href=https://ashang.github.io/zz/posts/2020-jan/#14-42-38-root-dev22-tmp>14:42:38 root@dev22:/tmp</a><li><a href=https://ashang.github.io/zz/posts/2020-jan/#-1></a><li><a href=https://ashang.github.io/zz/posts/2020-jan/#14-42-40-root-dev22-tmp>14:42:40 root@dev22:/tmp</a><li><a href=https://ashang.github.io/zz/posts/2020-jan/#sudo-apt-get-update>sudo apt-get update</a> <ul><li><a href=https://ashang.github.io/zz/posts/2020-jan/#which-dns-am-i-using>Which DNS am I using</a></ul><li><a href=https://ashang.github.io/zz/posts/2020-jan/#14-46-15-aaron-code-b>14:46:15 aaron@code:~/b</a><li><a href=https://ashang.github.io/zz/posts/2020-jan/#14-46-15-aaron-code-b-1>14:46:15 aaron@code:~/b</a> <ul><li><a href=https://ashang.github.io/zz/posts/2020-jan/#php>PHP</a></ul><li><a href=https://ashang.github.io/zz/posts/2020-jan/#sudo-pecl-install-expect-warning-channel-pecl-php-net-has-updated-its-protocols-use-pecl-channel-update-pecl-php-net-to-update-downloading-expect-0-4-0-tgz>sudo pecl install expect WARNING: channel "pecl.php.net" has updated its protocols, use "pecl channel-update pecl.php.net" to update downloading expect-0.4.0.tgz ...</a><li><a href=https://ashang.github.io/zz/posts/2020-jan/#17-07-29-root-dev22>17:07:29 root@dev22:~</a><li><a href=https://ashang.github.io/zz/posts/2020-jan/#sudo-netstat-plutn-grep-i-sql>sudo netstat -plutn | grep -i sql</a><li><a href=https://ashang.github.io/zz/posts/2020-jan/#17-07-30-root-dev22>17:07:30 root@dev22:~</a> <ul><li><a href=https://ashang.github.io/zz/posts/2020-jan/#lighttpd-with-fpm>lighttpd with fpm</a><li><a href=https://ashang.github.io/zz/posts/2020-jan/#todo>TODO</a></ul></ul><section class=body><h2 id=breed>Breed</h2><p>环境变量设置已成功更新，将在重启后生效。 启用环境变量可以使 Breed 的一些设置能够被修改并保存。<ul><li>对于 TP-LINK 固件，请选择 [Breed 内部]，环境变量将储存在 Breed 分区末尾，更新 Breed 会导致环境变量数据丢失。<li>对于 LSDK 和 QSDK 固件，请选择 [LSDK/QSDK]，更新 Breed 会导致环境变量被禁用，但不会清除环境变量数据。<li>对于 AR724X 的 UBNT 固件，请选择 [UBNT.XM]，其特性与 [LSDK/QSDK] 相同。<li>对于其它类型的固件，请选择 [Breed 内部]。</ul><p>请仅在十分熟悉固件结构、十分有把握的情况下，使用自定义位置。<p>控制 禁用 启用 位置 自定义 起始地址 大小 (字节) 设置<p>Boot and Recovery Environment for Embedded Devices (BREED) A multi-task bootloader with real-time firmware upgrading progress. NOT A U-BOOT MODIFICATION! Copyright (C) 2022 Weijie Gao Revision: r1416 [2022-07-24] 当前版本：r1416 [2022-07-24]<ul><li>Networking support ---> Networking options ---> Distributed Switch Architecture<li>Device Drivers ---> Network device support ---> Distributed Switch Architecture drivers ---></ul><h2 id=xiu-ding-hao-r1416-gitti-jiao-ji-lu-46ae2a1>修订号 r1416，git提交记录 46ae2a1 ??</h2><p>https://github.com/pinczakko/AMIBIOS8_1B_Utils<p>可插拔式的，DIP 的插座和 DIP 封装的 SPI Flash。<p>x86 复位后，物理地址 0xf0000 - 0xfffff 会映射到 ROM，也就是 BIOS 所在的 SPI Flash 中的空间。<blockquote><p>x86 实模式下，低端 640KB 内存是给用户使用的， 往上是映射的显存，一些扩展的 BIOS 数据，再往上就是 BIOS ROM 映射范围了。在 MBR 阶段，MBR 需要调用 BIOS 中断来从存储设备中加载后续的 Bootloader 来运行。 那么 BIOS 中断服务代码放在哪呢？BIOS ROM 就有 512KB，而 BIOS ROM 映射范围一般是 64KB，最多 128KB，也不够装下整个 BIOS 的内容。 因此 BIOS 选择了将 BIOS 中断服务单独做成了一个模块，在 BIOS 将 CPU 控制权交到 MBR 之前，将 BIOS ROM 映射关掉，然后将 BIOS 中断服务代码放入这片区域。 这样既解决了BIOS ROM 不能完全映射的问题，也避免了 BIOS 中断服务代码占用低端内存 640KB 的用户区域。</blockquote><p>我没有电脑手机播放器什么的，只有电脑主机又没有显示器又喜欢听歌；考虑到硬盘噪音，就 CDLive 了 GeeXBox 拿来听歌用（x<p>无线网卡是 Realtek RTL8188CE，150M。这个网卡在 Windows 下使用还没什么，但在 Linux 下，就极不稳定。因为驱动的关系，无线网每隔10几分钟就会断开，需要重连。这是让人非常不爽的。另外，因为路由是 300M 的，这个网卡连带宽都不能完全使用，简直是浪费。<p>于是乎，我就想到了更换无线网卡。由于之前研究路由器，积累了一些无线网卡芯片的信息，我决定选用和我的 300M 路由一个型号的无线网卡，其芯片是 Atheros AR9287，网卡型号是 AR5B97。<p>本来嘛，换网卡应该是很简单的事，但由于 ThinkPad BIOS 对网卡作了白名单限制，因此事情就变得麻烦了。这里记下来，留作参考。<p>何为白名单？其实就是计算机生产商为了保护自己的设备硬件不被轻易更换，而对硬件作了限制，当检测到计算机接入了不在白名单内的硬件，就阻止开机，并提示更换硬件。<pre style=background:#0f1419;color:#bfbab0><code><span>    PCI\VEN_168C&DEV_002E&SUBSYS_660311AD&REV_01\4&...
</span></code></pre><p>其中 VEN 后面的 168C 就是 VID，DEV 后的 002E 就是 DID，另外一个要记下来的是 SubSystem ID 660311AD。另外在 Linux 下使用 lspci 命令就可以看到所有 PCI 设备的信息。旧的 Realtek RTL8818CE 的信息是 VID = 10EC， DID = 8176， SubSystem ID = 819510EC。<p>将 je short environm.100185B1 的 je 改为 jmp；将 jnz short environm.100185CF 的 jnz 改为 jmp，保存。<p>用 RW Everything 保存系统的 ACPI 表<h1 id=openwrt-to-debian-on-atheros-router>OpenWrt to Debian on Atheros router</h1><p>虽然可以直接将 OpenWrt 编译出的 ko 复制到 Debian 中加载，但是这却有不少问题：<ol><li>ko 被精简过，缺少必要信息，如 depmods<li>编译的 ko 很少<li>无法被自动加载/按需加载</ol><p>此外，使用 OpenWrt 的 ko，而不自己编译，会导致系统缺少针对当前 Kernel 的头文件，无法实现在 Debian 中编译自己的 ko。<p>因此，我需要自己编译 Debian Kernel，也就是修改原始的 Debian Kernel 源代码，加入 OpenWrt 的部分 patch，修改 config，并编译，生成 kernel、header file、kernel modules。<p>然后找找到 kernel 版本号最新的 linux_4.19.?? 文件，例如 4.19.67，然后下载相关的几个源码包： linux_4.19.67-2+deb10u1.debian.tar.xz linux_4.19.67.orig.tar.xz<ol start=2><li><p>准备 Kernel 源代码 首先解压 linux_4.19.67.orig.tar.xz。 然后解压 linux_4.19.67-2+deb10u1.debian.tar.xz，并将其中的 debian 目录放入前面解压得到的源码根目录中 (包含 Makefile 的那一层)。</p><li><p>给源码打上 OpenWrt 的 patch OpenWrt 针对路由器平台的一些特殊的优化/功能更新也需要合进源码。对于 patch 的选择需要一定的经验。</p><li><p>向 Debian package 增加一个新的 flavour Debian 将系统平台分为3部分：arch/featureset/flavour， 其中 arch 即为 CPU 架构，这里 MT7621 对应的是 mipsel， featureset 没用到，为 none， flavour 对应 CPU 架构下的具体平台，因此需要创建一个 MT7621 对应的 flavour，就叫 mt7621。</p></ol><p>修改全程以 4kc-malta 为参考。<p>4.1 修改 debian/config/mipsel/defines，增加如下内容： 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 --- a/debian/config/mipsel/defines +++ b/debian/config/mipsel/defines @@ -4,6 +4,7 @@ flavours: 5kc-malta loongson-3 octeon<ul><li>mt7621 kernel-arch: mips</ul><p>[build] @@ -43,3 +44,11 @@ hardware-long: Cavium Networks Octeon<p>[octeon_image] configs: kernelarch-mips/config.octeon<ul><li></ul><p>+[mt7621_description] +hardware: MT7621 +hardware-long: MediaTek MT7621 boards<ul><li></ul><p>+[mt7621_image] +configs:<ul><li>kernelarch-mips/config.mt7621 4.2 创建 debian/config/kernelarch-mips/config.mt7621 文件 这个文件里面填入编译 MT7621 kernel 必需的各种 Kconfig 项目、不打算开启的项目以及需要编译为 ko 的项目。</ul><p>这里完全按自己的需求来写。可以先 menuconfig 配置完成，再把 .config 改名为 config.mt7621。<p>必选： CONFIG_MODVERSIONS=y (Enable loadable module support ---> Module versioning support) CONFIG_MIPS_RAW_APPENDED_DTB=y (Kernel type ---> Kernel appended dtb support ---> vmlinux.bin or vmlinuz.bin)<p>4.3 创建 debian/installer/modules/mipsel-mt7621 目录 参考 mipsel-4kc-malta 将需要打包的 ko 文件列表写入目录文件中<p>4.4 创建 debian/abi/4.19.0-6/mipsel_none_mt7621 创建空文件即可<ol start=5><li>准备编译环境 一定要使用 Debian 或其衍生版，如 Ubuntu 作为编译环境，这样才不会缺少工具。</ol><p>5.1 安装必要的软件 fakeroot git kernel-wedge quilt ccache flex bison libssl-dev dh-exec gcc-8-mipsel-linux-gnu gcc-mipsel-linux-gnu<p>5.2 编译目标平台下的一些库，供 gcc-mipsel-linux-gnu 使用 到 https://mirrors.tuna.tsinghua.edu.cn/debian/pool/main/e/elfutils/ 下载最新的安装包： libelf1_0.176-1.1_mipsel.deb libelf-dev_0.176-1.1_mipsel.deb<p>到 https://mirrors.tuna.tsinghua.edu.cn/debian/pool/main/o/openssl/ 下载最新的安装包： libssl1.1_1.1.1c-1_mipsel.deb libssl-dev_1.1.1c-1_mipsel.deb<p>到 https://mirrors.tuna.tsinghua.edu.cn/debian/pool/main/z/zlib/ 下载最新的安装包： zlib1g-dev_1.2.11.dfsg-1+b1_mipsel.deb zlib1g_1.2.11.dfsg-1_mipsel.deb<p>将其中的 data.tar.xz 提取出来并解压，将头文件和库复制到 /usr/mipsel-linux-gnu 下面对应的目录<p>到 https://mirrors.tuna.tsinghua.edu.cn/debian/pool/main/g/glibc/ 下载最新的安装包： libc6_2.28-10_mipsel.deb<p>先将 /usr/mipsel-linux-gnu/lib/libc.so.6 备份，然后将 libc6_2.28-10_mipsel.deb 里面的 libc.so.6 覆盖到 /usr/mipsel-linux-gnu/lib/。 等 6.3 节完成后，还原备份的 libc.so.6。<ol start=6><li>编译 Kernel 6.1 设置环境变量 1 2 3 4 5 6 7 8 9 10 11 12 export ARCH=mipsel export FEATURESET=none export FLAVOUR=mt7621</ol><p>export $(dpkg-architecture -a$ARCH) export PATH=/usr/lib/ccache:$PATH<h1 id=she-ding-ben-ci-bian-yi-wei-jiao-cha-bian-yi-build-profiles-ju-ti-nei-rong-qing-can-kao-debian-readme-source>设定本次编译为交叉编译（Build profiles 具体内容请参考 debian/README.source）</h1><p>export DEB_BUILD_PROFILES="cross nopython nodoc"<h1 id=kai-qi-bing-xing-bian-yi>开启并行编译</h1><p>export MAKEFLAGS="-j$(($(nproc)*2))"<h1 id=jin-zhi-bian-yi-dbg-ruan-jian-bao>禁止编译 -dbg 软件包</h1><p>export DEBIAN_KERNEL_DISABLE_DEBUG=yes 6.2 编译 Kernel 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20<h1 id=qing-li-shang-ci-bian-yi-de-zhong-jian-wen-jian>清理上次编译的中间文件</h1><p>fakeroot make -f debian/rules clean<h1 id=zhe-li-zhi-xing-hou-hui-ti-shi-cuo-wu-hu-lue-ji-ke>这里执行后会提示错误，忽略即可</h1><h1 id=jie-bao-yuan-shi-yuan-dai-ma-xu-jiang-linux-4-19-67-orig-tar-xz-fang-dao-shang-ji-mu-lu-yu-linux-4-19-67-ping-ji>解包原始源代码，需将 linux_4.19.67.orig.tar.xz 放到上级目录 (与 linux_4.19.67 平级)</h1><h1 id=zhe-yi-bu-bu-neng-sheng-lue-yin-wei-debian-yao-bao-zheng-mei-ci-du-shi-shi-yong-xiang-tong-de-gan-jing-de-dai-ma-ji-zhi-da-shang-liao-debian-patches-li-de-patch-wen-jian-jin-xing-bian-yi>这一步不能省略，因为 Debian 要保证每次都是使用相同的干净的代码（即只打上了 debian/patches 里的 patch 文件）进行编译</h1><p>fakeroot make -f debian/rules orig<h1 id=zhun-bei-yuan-dai-ma-da-patch-sheng-cheng-control-wen-jian-sheng-cheng-bian-yi-gui-ze-deng>准备源代码（打 patch，生成 control 文件，生成编译规则等）</h1><p>fakeroot make -f debian/rules source<h1 id=sheng-cheng-config-deng-pei-zhi-wen-jian>生成 .config 等配置文件</h1><p>fakeroot make -f debian/rules.gen setup_${ARCH}<em>${FEATURESET}</em>${FLAVOUR}<h1 id=bian-yi>编译</h1><h1 id=she-zhi-language-c-utf-8-shi-wei-liao-bi-mian-zai-fei-ying-wen-xi-tong-li-bian-yi-chu-xian-cuo-wu>设置 LANGUAGE=C.UTF-8 是为了避免在非英文系统里编译出现错误</h1><p>LANGUAGE=C.UTF-8 fakeroot make -f debian/rules.gen binary-arch_${ARCH}<em>${FEATURESET}</em>${FLAVOUR}<h1 id=sheng-cheng-linux-headers-common-deng-bao>生成 linux-headers-common 等包</h1><p>LANGUAGE=C.UTF-8 fakeroot make -f debian/rules.gen binary-indep 6.3 编译 linux-kbuild 包 这个包本来是不能交叉编译的，因为它会链接一些目标平台的库，这些库本来是不会存在于编译环境的。<p>但是在 5.2 节时，我已经将这些库交叉编译并放入了交叉编译工具链中，因此才能编译 linux-kbuild 包。<p>打开 debian/rules.real，找到 install-kbuild: 目标，将其后命令中的 dh_shlibdeps 注释掉，以屏蔽库依赖检查。<p>打开 debian/rules.gen，找到 build-arch_mipsel_none_mt7621_real:: 这个目标，将其后的具体命令，复制出来。<p>将其中的 build-arch-flavour 修改为 install-kbuild 以强制编译 install-kbuild。同时将 $(MAKE) 修改为 fakeroot make。<p>fakeroot make -f debian/rules.real install-kbuild ABINAME='4.19.0-6' ARCH='mipsel' COMPILER='gcc-8' DEBUG='True' FEATURESET='none' FLAVOUR='mt7621' IMAGE_FILE='vmlinux' IMAGE_INSTALL_STEM='vmlinux' IMAGE_PACKAGE_NAME='linux-image-4.19.0-6-mt7621' KCONFIG='debian/config/config debian/config/kernelarch-mips/config debian/config/mipsel/config debian/config/kernelarch-mips/config.mt7621' KCONFIG_OPTIONS=' -o DEBUG_INFO=y -o "BUILD_SALT="4.19.0-6-mt7621""' KERNEL_ARCH='mips' LOCALVERSION='-mt7621' LOCALVERSION_HEADERS='' LOCALVERSION_IMAGE='-mt7621' SOURCEVERSION='4.19.67-2+deb10u1' SOURCE_BASENAME='linux' UPSTREAMVERSION='4.19' VERSION='4.19'<p>在当前编译目录下直接执行此命令即可。<p>6.4 制作可启动的 kernel uImage 编译出来的 kernel vmlinux 并不能直接拿给 u-boot/breed 等 Bootloader 使用，需要进行以下步骤的处理：<p>假设： OPENWRT_ROOT 是 OpenWrt 源代码的根目录 KERNEL_ROOT 是要编译的 Kernel 源代码的根目录 BUILD_DIR 是实际编译并生成 vmlinux 文件的目录，一般是 ${KERNEL_ROOT}/debian/build/build_mipsel_none_mt7621 DTS_DIR 是未经预处理的原始 dts 所在的目录 SRC_DTS 是未经预处理的原始 dts，它依赖别的 dtsi （如 mt7621.dtsi） FINAL_DTS 是经过预处理的完整的 dts FINAL_DTB 是经过编译的 dts 二进制文件<p>首先将 dts/dtsi 合并为一个文件：<p>1 mipsel-linux-gnu-cpp -nostdinc -x assembler-with-cpp -I${DTS_DIR} -I${KERNEL_ROOT}/include&ampamp;amp;amp;amp;amp;amp;nbsp; -undef -D__DTS__ -o ${FINAL_DTS} ${SRC_DTS} 然后编译 dts：<p>1 ${BUILD_DIR}/scripts/dtc/dtc -Idts -Odtb -i${KERNEL_ROOT}/include -o ${FINAL_DTB} ${FINAL_DTS} 获取 vmlinux 的加载地址： 在 ${KERNEL_ROOT}/arch/mips/ralink/Platform 里面 load-$(CONFIG_SOC_MT7621) 记录的就是 vmlinux 的加载地址 如 load-$(CONFIG_SOC_MT7621) += 0xffffffff80001000，但是只需要低32位，记为 LOADADDR = 0x80001000<p>获取 vmlinux 的入口点地址： mipsel-linux-gnu-objdump -f ${BUILD_DIR}/vmlinux 输出中以 "start address" 或者 "起始地址" 打头的那一行，后面记录的就是 vmlinux 的入口点地址 例如 起始地址 0x8067f8b0，记为 ENTRYADDR = 0x8067f8b0<p>提取 vmlinux.bin： vmlinux 是一个 elf 文件，不仅体积大，还不能被一般的 Bootloader 加载，因此要先提取 RAW 格式的二进制文件<p>1 mipsel-linux-gnu-objcopy -Obinary --gap-fill=0xff&ampamp;amp;amp;amp;amp;amp;nbsp;${BUILD_DIR}/vmlinux&ampamp;amp;amp;amp;amp;amp;nbsp;${BUILD_DIR}/vmlinux.bin 拼接 vmlinux.bin 与 dtb：<p>1 cat ${BUILD_DIR}/vmlinux.bin&ampamp;amp;amp;amp;amp;amp;nbsp;${FINAL_DTB} &ampamp;amp;amp;amp;amp;amp;amp;gt;&ampamp;amp;amp;amp;amp;amp;nbsp;${BUILD_DIR}/vmlinux.dtb.bin 压缩 vmlinux.dtb.bin： 不能使用系统自带的 xz 版的 lzma，它不支持 EOS 标记，生成的压缩文件无法被 Bootloader 解压。 必须使用 OpenWrt 提供的 7z 版的 lzma。<p>1 ${OPENWRT_ROOT}/staging_dir/host/bin/lzma e&ampamp;amp;amp;amp;amp;amp;nbsp;${BUILD_DIR}/vmlinux.dtb.bin&ampamp;amp;amp;amp;amp;amp;nbsp;-lc1 -lp2 -pb2 -d21&ampamp;amp;amp;amp;amp;amp;nbsp;${BUILD_DIR}/vmlinux.dtb.bin.lzma 制作可被 Bootloader 加载的 vmlinux uImage：<p>1 mkimage -A mips -O linux -T kernel -C lzma -a ${LOADADDR} -e ${ENTRYADDR} -n "Linux mipsel 4.19.67 MT7621" -d ${BUILD_DIR}/vmlinux.dtb.bin.lzma ${BUILD_DIR}/vmlinux.img 最后将 vmlinux.img 以升级固件的方式更新到 MT7621 板子上即可<h2></h2><p>Advanced configuration options (for developers) ---> Toolchain Options ---> C Library implementation ---> Use glibc (可选，如果需要把 OpenWrt 里面的程序复制到 Debian 里面直接使用) Base system ---> block-mount Base system ---> ca-bundle Network ---> File Transfer ---> wget Kernel modules ---> Cryptographic API modules ---> kmod-crypto-crc32c Kernel modules ---> Filesystems ---> kmod-fs-ext4 Kernel modules ---> Native Language Support ---> kmod-nls-utf8 Kernel modules ---> Other modules ---> kmod-sdhci-mt7620 Utilities ---> Disc ---> fdisk Utilities ---> Filesystem ---> e2fsprogs Utilities ---> Compression ---> xz-utils (要先选择它，否则 debootstrap 不会显示) Administration ---> debootstrap<p>修改 /usr/share/debootstrap/functions： 搜索 in_target mount -t sysfs sysfs /sys，将 mount 改成 /bin/mount<p>然后执行 debootstrap 开始制作 Debian rootfs：<p>1 root@OpenWrt:/# debootstrap --arch mipsel --include=perl,vim buster /mnt/debian_root http://ftp.cn.debian.org/debian/<p>2.3.2 创建初始设备节点 (可选，如果要在挂载 /dev 前调试 init)： 1 2 root@OpenWrt:/# mknod /dev/console c 5 1 root@OpenWrt:/# mknod /dev/ttyS0 c 4 64<p>debootstrap 创建的 Debian 系统，是没有 initramfs 的，因此必须将挂载 rootfs 所需的所有内核模块全部编译进 kernel<p>为了解决 /sbin/init 无输出的问题，我编写了 init 脚本用于调试，才知道是 /dev 下面没有 console 和 ttyS0 设备文件。<p>通过 debootstrap 创建的 Debian 系统，是没有 initramfs 的，因此必须将挂载 rootfs 所需的所有内核模块全部编译进 kernel。<p>3.1 Linux kernel 中需要修改的项目 Device Drivers ---> MMC/SD/SDIO card support ---> MMC block device driver Device Drivers ---> MMC/SD/SDIO card support ---> MTK SD/MMC (如果以后 MT762x 支持被添加到 mtk-sd.c 里面了，那么选择 MediaTek SD/MMC Card Interface support) File systems ---> The Extended 4 (ext4) filesystem File systems ---> Kernel automounter version 4 support (also supports v3) File systems ---> Native language support ---> Default NLS Option ---> utf8 File systems ---> Native language support ---> NLS UTF-8<p>另外，可以选上 USB 相关的： Device Drivers ---> SCSI device support ---> SCSI device support Device Drivers ---> SCSI device support ---> SCSI disk support Device Drivers ---> SCSI device support ---> SCSI generic support Device Drivers ---> USB support ---> Support for Host-side USB Device Drivers ---> USB support ---> xHCI HCD (USB 3.0) support Device Drivers ---> USB support ---> Generic xHCI driver for a platform device Device Drivers ---> USB support ---> xHCI support for Mediatek MT65xx/MT7621 Device Drivers ---> USB support ---> USB Mass Storage support Device Drivers ---> USB support ---> USB Attached SCSI<p>可以选上 SATA 相关的： Device Drivers ---> Serial ATA and Parallel ATA drivers (libata) ---> AHCI SATA support<p>去掉内置的 Kernel command line： Kernel hacking ---> 取消选择 Built-in kernel command line<p>3.2 OpenWrt 中需要修改的项目 去掉选择 OpenWrt 里面对应 3.1 中的 kmod package: kmod-crypto-crc32c kmod-fs-ext4 kmod-fs-autofs4 kmod-sdhci-mt7620 kmod-mmc kmod-nls-utf8 SATA 相关的： kmod-ata-core USB 相关的： kmod-scsi-core kmod-scsi-generic Kernel modules ---> USB Support 里面的全部取消 USB 相关的全部取消之后，即可取消 kmod-nls-base<p>选择 Debian 系统必需的： Global build settings ---> Kernel build options ---> Compile the kernel with device tmpfs enabled Global build settings ---> Kernel build options ---> Enable kernel cgroups Global build settings ---> Kernel build options ---> Enable kernel namespaces<p>修改 OpenWrt 的 dts 文件： target/linux/ramips/dts 里找到路由器对应的 dts 文件，修改其中的 bootargs =，增加如下内容： root=/dev/mmcblk0p1 rw rootwait<p>3.3 删除一些无用的 patch OpenWrt 里面一些用具精简 Kernel 的 patch 对于 Debian 来说意义不大了，因此可以删掉： /home/hackpascal/openwrt/openwrt-dev/target/linux/generic/pending-x.x: 305-mips_module_reloc.patch 307-mips_highmem_offset.patch<p>只需要 Kenrel 本身，不需要 rootfs，因此执行以下命令进行编译：<p>1 make target/linux/install V=s<h2 id=fan-zha>Fan Zha</h2><h1 id=sudo-apt-get-install-expect-dev>sudo apt-get install expect-dev</h1><p>Reading package lists... Done Building dependency tree Reading state information... Done The following packages were automatically installed and are no longer required: libfile-copy-recursive-perl libfontenc1 libice6 libpthread-stubs0 libpthread-stubs0-dev libsm6 libx11-dev libx11-doc libxau-dev libxaw7 libxcb-shape0 libxcb1-dev libxdmcp-dev libxext-dev libxmu6 libxmuu1 libxpm4 libxrender-dev libxss-dev libxss1 libxt6 libxtst6 libxv1 libxxf86dga1 tk8.5 update-inetd x11-common x11-utils x11proto-core-dev x11proto-input-dev x11proto-kb-dev x11proto-render-dev x11proto-scrnsaver-dev x11proto-xext-dev xbitmaps xorg-sgml-doctools xterm xtrans-dev Use 'apt-get autoremove' to remove them. The following extra packages will be installed: tcl8.5-dev Suggested packages: tcl8.5-doc Recommended packages: tk8.5-dev The following NEW packages will be installed: expect-dev tcl8.5-dev 0 upgraded, 2 newly installed, 0 to remove and 5 not upgraded. Need to get 1,244 kB of archives. After this operation, 3,835 kB of additional disk space will be used. Do you want to continue [Y/n]? WARNING: The following packages cannot be authenticated! tcl8.5-dev expect-dev Install these packages without verification [y/N]? y Err http://archive.debian.org/debian/ wheezy/main expect-dev amd64 5.45-2 Could not resolve '182.43.124.6?parameter=04df97a21ed6ff09ac8089fdff13a7191697006442.882|04df97a21ed6ff09ac8089fdff13a719archive.debian.org|04df97a21ed6ff09ac8089fdff13a719' Err http://archive.debian.org/debian/ wheezy/main tcl8.5-dev amd64 8.5.11-2 Could not resolve '182.43.124.6?parameter=04df97a21ed6ff09ac8089fdff13a7191697006442.849|04df97a21ed6ff09ac8089fdff13a719archive.debian.org|04df97a21ed6ff09ac8089fdff13a719' Failed to fetch http://archive.debian.org/debian/pool/main/t/tcl8.5/tcl8.5-dev_8.5.11-2_amd64.deb Could not resolve '182.43.124.6?parameter=04df97a21ed6ff09ac8089fdff13a7191697006442.849|04df97a21ed6ff09ac8089fdff13a719archive.debian.org|04df97a21ed6ff09ac8089fdff13a719' Failed to fetch http://archive.debian.org/debian/pool/main/e/expect/expect-dev_5.45-2_amd64.deb Could not resolve '182.43.124.6?parameter=04df97a21ed6ff09ac8089fdff13a7191697006442.882|04df97a21ed6ff09ac8089fdff13a719archive.debian.org|04df97a21ed6ff09ac8089fdff13a719' E: Unable to fetch some archives, maybe run apt-get update or try with --fix-missing?<h1 id=14-42-38-root-dev22-tmp>14:42:38 root@dev22:/tmp</h1><h1 id=-1></h1><h1 id=14-42-40-root-dev22-tmp>14:42:40 root@dev22:/tmp</h1><h1 id=sudo-apt-get-update>sudo apt-get update</h1><p>Err http://archive.debian.org wheezy Release.gpg Could not resolve '182.43.124.6?parameter=04df97a21ed6ff09ac8089fdff13a7191697006447.824|04df97a21ed6ff09ac8089fdff13a719archive.debian.org|04df97a21ed6ff09ac8089fdff13a719' Reading package lists... Done W: Failed to fetch http://archive.debian.org/debian/dists/wheezy/Release.gpg Could not resolve '182.43.124.6?parameter=04df97a21ed6ff09ac8089fdff13a7191697006447.824|04df97a21ed6ff09ac8089fdff13a719archive.debian.org|04df97a21ed6ff09ac8089fdff13a719'<p>W: Some index files failed to download. They have been ignored, or old ones used instead.<h2 id=which-dns-am-i-using>Which DNS am I using</h2><p>$ dig http://www.google.ca<p>; <<>> DiG 9.18.19-1~deb12u1-Debian <<>> http://www.google.ca<br> ;; global options: +cmd<br> ;; Got answer:<br> ;; ->>HEADER<&LT- opcode: QUERY, status: NOERROR, id: 19517<br> ;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0<p>;; QUESTION SECTION:<br> ;http://www.google.ca. IN A<p>;; ANSWER SECTION:<br> http://www.google.ca. 77 IN A 69.197.153.180<p>;; Query time: 24 msec<br> ;; SERVER: 10.10.50.10#53(10.10.50.10) (UDP)<br> ;; WHEN: Wed Oct 11 14:46:15 CST 2023<br> ;; MSG SIZE rcvd: 54<h1 id=14-46-15-aaron-code-b>14:46:15 aaron@code:~/b</h1><p>$<h1 id=14-46-15-aaron-code-b-1>14:46:15 aaron@code:~/b</h1><p>$ sudo apt install bind9-dnsutils<p>run the “resolvectl status” command to see the detail about the current used DNS server<p>$ nslookup www.google.ca<br> Server: 10.10.50.10<br> Address: 10.10.50.10#53<p>Non-authoritative answer:<br> Name: www.google.ca<br> Address: 52.58.1.161<br> Name: www.google.ca<br> Address: 2a03:2880:f11f:83:face:b00c:0:25de<p>$ host www.google.ca<br> www.google.ca has address 52.58.1.161<br> www.google.ca has IPv6 address 2a03:2880:f11f:83:face:b00c:0:25de<br> www.google.ca has address 118.193.202.219<p>root@gns3:~# resolvectl status<br> Global<br> Protocols: -LLMNR -mDNS -DNSOverTLS DNSSEC=no/unsupported<br> resolv.conf mode: stub<p>Link 2 (enp6s0)<br> Current Scopes: none<br> Protocols: -DefaultRoute +LLMNR -mDNS -DNSOverTLS DNSSEC=no/unsupported<p>Link 3 (enp7s0)<br> Current Scopes: none<br> Protocols: -DefaultRoute +LLMNR -mDNS -DNSOverTLS DNSSEC=no/unsupported<p>Link 4 (eno1)<br> Current Scopes: DNS<br> Protocols: +DefaultRoute +LLMNR -mDNS -DNSOverTLS DNSSEC=no/unsupported<br> Current DNS Server: 10.10.50.10<br> DNS Servers: 10.10.50.10 1.0.0.1 9.9.9.9<br> DNS Domain: pica8.local<p>Link 5 (enp8s0)<br> Current Scopes: none<br> Protocols: -DefaultRoute +LLMNR -mDNS -DNSOverTLS DNSSEC=no/unsupported<p>Link 6 (enp9s0)<br> Current Scopes: none<br> Protocols: -DefaultRoute +LLMNR -mDNS -DNSOverTLS DNSSEC=no/unsupported<p>Link 7 (eno2)<br> Current Scopes: none<br> Protocols: -DefaultRoute +LLMNR -mDNS -DNSOverTLS DNSSEC=no/unsupported<p>Link 8 (eno3)<br> Current Scopes: none<br> Protocols: -DefaultRoute +LLMNR -mDNS -DNSOverTLS DNSSEC=no/unsupported<p>Link 9 (eno4)<br> Current Scopes: none<br> Protocols: -DefaultRoute +LLMNR -mDNS -DNSOverTLS DNSSEC=no/unsupported<p>Link 10 (enp67s0f0)<br> Current Scopes: none<br> Protocols: -DefaultRoute +LLMNR -mDNS -DNSOverTLS DNSSEC=no/unsupported<p>Link 11 (enp67s0f1)<br> Current Scopes: none<br> Protocols: -DefaultRoute +LLMNR -mDNS -DNSOverTLS DNSSEC=no/unsupported<p>Link 12 (enp67s0f2)<br> Current Scopes: none<br> Protocols: -DefaultRoute +LLMNR -mDNS -DNSOverTLS DNSSEC=no/unsupported<p>Link 13 (enp67s0f3)<br> Current Scopes: none<br> Protocols: -DefaultRoute +LLMNR -mDNS -DNSOverTLS DNSSEC=no/unsupported<p>Link 14 (virbr0)<br> Current Scopes: none<br> Protocols: -DefaultRoute +LLMNR -mDNS -DNSOverTLS DNSSEC=no/unsupported<p>Link 15 (docker0)<br> Current Scopes: none<br> Protocols: -DefaultRoute +LLMNR -mDNS -DNSOverTLS DNSSEC=no/unsupported<h2 id=php>PHP</h2><p>2023-10-11 11:31:01: (mod_fastcgi.c.451) FastCGI-stderr:PHP message: PHP Warning: mysql_connect(): Can't connect to MySQL server on '10.10.50.22' (111) in /disk/srv/box/boxuser.php on line 98<p>It probably means that your MySQL server is only listening the localhost interface.<p>If you have lines like this :<p>bind-address = 127.0.0.1 In your my.cnf configuration file, you should comment them (add a # at the beginning of the lines), and restart MySQL.<p>2023-10-11 14:32:46: (mod_fastcgi.c.451) FastCGI-stderr:PHP message: PHP Warning: mysql_connect(): Host 'dev22.pica8.local' is not allowed to connect to this MySQL server in /disk/srv/box/boxuser.php on line 98<p>hostname -f<p>hostname -A<p>2023-10-11 14:38:26: (mod_fastcgi.c.451) FastCGI-stderr:PHP message: PHP Fatal error: Call to undefined function expect_popen() in /disk/srv/box/boxownerInsert.php on line 19<p>apt install php-pear<h1 id=sudo-pecl-install-expect-warning-channel-pecl-php-net-has-updated-its-protocols-use-pecl-channel-update-pecl-php-net-to-update-downloading-expect-0-4-0-tgz>sudo pecl install expect WARNING: channel "pecl.php.net" has updated its protocols, use "pecl channel-update pecl.php.net" to update downloading expect-0.4.0.tgz ...</h1><p>Starting to download expect-0.4.0.tgz (9,812 bytes) .....done: 9,812 bytes 6 source files, building running: phpize<br> Configuring for:<br> PHP Api Version: 20100412<br> Zend Module Api No: 20100525<br> Zend Extension Api No: 220100525<br> building in /tmp/pear/temp/pear-build-rootSmzJOX/expect-0.4.0<br> running: /tmp/pear/temp/expect/configure<br> checking for grep that handles long lines and -e... /usr/bin/grep<br> checking for egrep... /usr/bin/grep -E<br> checking for a sed that does not truncate output... /usr/bin/sed<br> checking for cc... cc<br> checking whether the C compiler works... yes<br> checking for C compiler default output file name... a.out<br> checking for suffix of executables...<br> checking whether we are cross compiling... no<br> checking for suffix of object files... o<br> checking whether we are using the GNU C compiler... yes<br> checking whether cc accepts -g... yes<br> . . .<p>Build complete.<br> Don't forget to run 'make test'.<p>running: make INSTALL_ROOT="/tmp/pear/temp/pear-build-rootSmzJOX/install-expect-0.4.0" install<br> Installing shared extensions: /tmp/pear/temp/pear-build-rootSmzJOX/install-expect-0.4.0/usr/lib/php5/20100525/<br> running: find "/tmp/pear/temp/pear-build-rootSmzJOX/install-expect-0.4.0" | xargs ls -dils<br> 97247916 4 drwxr-xr-x 3 root root 4096 Oct 11 17:02 /tmp/pear/temp/pear-build-rootSmzJOX/install-expect-0.4.0<br> 97247940 4 drwxr-xr-x 3 root root 4096 Oct 11 17:02 /tmp/pear/temp/pear-build-rootSmzJOX/install-expect-0.4.0/usr<br> 97247941 4 drwxr-xr-x 3 root root 4096 Oct 11 17:02 /tmp/pear/temp/pear-build-rootSmzJOX/install-expect-0.4.0/usr/lib<br> 97247942 4 drwxr-xr-x 3 root root 4096 Oct 11 17:02 /tmp/pear/temp/pear-build-rootSmzJOX/install-expect-0.4.0/usr/lib/php5<br> 97247943 4 drwxr-xr-x 2 root root 4096 Oct 11 17:02 /tmp/pear/temp/pear-build-rootSmzJOX/install-expect-0.4.0/usr/lib/php5/20100525<br> 97247939 84 -rwxr-xr-x 1 root root 78069 Oct 11 17:02 /tmp/pear/temp/pear-build-rootSmzJOX/install-expect-0.4.0/usr/lib/php5/20100525/expect.so<p>Build process completed successfully<br> Installing '/usr/lib/php5/20100525/expect.so'<br> install ok: channel://pecl.php.net/expect-0.4.0<br> configuration option "php_ini" is not set to php.ini location<br> You should add "extension=expect.so" to php.ini<p>TO:<p>/etc/php5/fpm/php.ini<p>You can find your php.ini file location by running:<p>bash Copy code php -i | grep "Loaded Configuration File"<p>$ php -i | grep "Loaded Configuration File"<br> Loaded Configuration File => /etc/php/8.2/cli/php.ini<h1 id=17-07-29-root-dev22>17:07:29 root@dev22:~</h1><h1 id=sudo-netstat-plutn-grep-i-sql>sudo netstat -plutn | grep -i sql</h1><p>tcp 0 0 0.0.0.0:3306 0.0.0.0:* LISTEN 22178/mysqld<h1 id=17-07-30-root-dev22>17:07:30 root@dev22:~</h1><p>If all the previous answers didn't give any solution, you should check your user privileges.<p>If you could login as root to mysql then you should add this:<p>CREATE USER 'root'@'192.168.1.100' IDENTIFIED BY '<em><strong>'; GRANT ALL PRIVILEGES ON * . * TO 'root'@'192.168.1.100' IDENTIFIED BY '</strong></em>' WITH GRANT OPTION MAX_QUERIES_PER_HOUR 0 MAX_CONNECTIONS_PER_HOUR 0 MAX_UPDATES_PER_HOUR 0 MAX_USER_CONNECTIONS 0 ; Then try to connect again using mysql -ubeer -pbeer -h192.168.1.100. It should work.<p>Check Extension Loading:<p>You can verify that the extension is loaded by running the following command:<p>bash Copy code php -m | grep expect If it doesn't return anything, the extension is not loaded, and you should revisit the PHP configuration to ensure the "extension=expect.so" line is correctly placed in the php.ini file.<p>PHP CLI vs. Web Server:<p>Make sure that you are modifying the correct php.ini file. PHP can have different configurations for the command-line interface (CLI) and the web server. If you are running your PHP script through a web server, the configuration should be updated in the web server's PHP configuration (e.g., /etc/php/7.x/apache2/php.ini). If you are using the PHP CLI, update the CLI's configuration (e.g., /etc/php/7.x/cli/php.ini).<p>Permissions:<p>Ensure that your web server process has read access to the php.ini file and the Expect extension files.<p>The choice between using PHP-FPM (FastCGI Process Manager) and mod_fastcgi depends on the web server you are using and your specific requirements. Both options provide FastCGI support for running PHP scripts, but they have different characteristics and may be better suited for different use cases:<p>PHP-FPM (FastCGI Process Manager):<p>PHP-FPM is a separate process manager for PHP that handles FastCGI requests. It's commonly used with web servers like Nginx and Apache. PHP-FPM has several advantages:<p>Performance: PHP-FPM is known for its high performance and low memory usage. It can handle a large number of PHP requests efficiently.<p>Isolation: PHP-FPM separates PHP processes for different users or websites, providing better security and resource isolation.<p>Tuning: You can fine-tune PHP-FPM's configuration to control how PHP processes are managed, including the number of child processes and resource limits.<p>Scalability: PHP-FPM is suitable for environments where you need to scale PHP processes to handle varying levels of traffic.<p>If you are using Nginx or prefer a dedicated PHP process manager, PHP-FPM is a popular and efficient choice.<h3 id=lighttpd-with-fpm>lighttpd with fpm</h3><p>sudo apt install lighttpd php-fpm<p>Edit the PHP-FPM configuration file to specify the socket or IP address where PHP-FPM will listen for FastCGI requests. The PHP-FPM configuration file is typically located at /etc/php/<version>/fpm/pool.d/www.conf. Adjust the configuration as needed. <p>Configure Lighttpd:</p> <p>Configure Lighttpd to use FastCGI for PHP by editing its configuration file. This file is usually located at /etc/lighttpd/lighttpd.conf. Here's a basic example of what you can add to this file:</p> <p>plaintext Copy code fastcgi.server = ( ".php" => (( "socket" => "/var/run/php/php7.4-fpm.sock", "broken-scriptfilename" => "enable" )) ) Adjust the socket path and any other settings as per your PHP-FPM configuration.</p> <p>Restart Services:</p> <p>After configuring both PHP-FPM and Lighttpd, restart both services:</p> <p>bash Copy code sudo systemctl restart php7.4-fpm sudo systemctl restart lighttpd This setup allows Lighttpd to communicate with PHP-FPM via FastCGI, enabling you to run PHP scripts efficiently and securely. Be sure to customize your configuration as needed to match your server's requirements.</p> <p>2023-10-11 17:44:09: (mod_fastcgi.c.451) FastCGI-stderr:PHP message: PHP Notice: Use of undefined constant AssignTo - assumed 'AssignTo' in /disk/srv/box/boxuser.php on line 148</p> <p>??</p> <p>j/z/talezola/content/20</p> <h3 id=todo>TODO</h3> <ul><li><p>NoVNC</p><li><p>NoSSH? to launch term or choose self run ones</p><li><p>Get a token before the above step</p><li><p>use python pexpect, becuase php expect extension has no recent active releases for a long while</p><li><p>add fields, such as CPU arch</p></ul> 