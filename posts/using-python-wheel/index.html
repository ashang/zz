<!doctype html><html class="dark light"><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><title>
         Python wheels
        
    </title><meta content="Python wheels" property=og:title><meta content="What are wheels and why/how should I use them" property=og:description><meta content="What are wheels and why/how should I use them" name=description><link href=/icon/favicon.png rel=icon type=image/png><link href=https://ashang.github.io/zz/fonts.css rel=stylesheet><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']]}}</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link href=https://ashang.github.io/zz/atom.xml rel=alternate title=atbb type=application/atom+xml><link href=https://ashang.github.io/zz/theme/light.css rel=stylesheet><link href=https://ashang.github.io/zz/theme/dark.css id=darkModeStyle rel=stylesheet><link href=https://ashang.github.io/zz/main.css media=screen rel=stylesheet><body><div class=content><header><div class=main><a href=https://ashang.github.io/zz/>atbb</a><div class=socials><a class=social href=https://github.com/ashang/ rel=me> <img alt=github src=/social_icons/github.svg> </a></div></div><nav><a href=$BASE_URL/search/ style=margin-left:.7em>Search</a><a href=/notes style=margin-left:.7em>/notes</a><a href=/posts style=margin-left:.7em>/posts</a><a href=/gallery style=margin-left:.7em>/gallery</a><a href=/tags style=margin-left:.7em>/tags</a><a href=/projects style=margin-left:.7em>/projects</a> | <a href=javascript:void(0) id=dark-mode-toggle onclick=toggleTheme()> <img id=sun-icon src=/feather/sun.svg style=filter:invert(1)> <img id=moon-icon src=/feather/moon.svg> </a><script src=https://ashang.github.io/zz/js/themetoggle.js></script></nav></header><main><article><div class=title><div class=page-header>Python wheels<span class=primary-color style=font-size:1.6em>.</span></div><div class=meta>Posted on <time>2014-05-24</time></div></div><h1>Table of Contents</h1><ul><li><a href=https://ashang.github.io/zz/posts/using-python-wheel/#why-should-i-care>Why should I care</a><li><a href=https://ashang.github.io/zz/posts/using-python-wheel/#how-to-use-them>How to use them</a></ul><section class=body><p>To quote <a href=http://legacy.python.org/dev/peps/pep-0427/>PEP 427</a>, wheel is:<blockquote><p>A wheel is a ZIP-format archive with a specially formatted file name and the .whl extension. It contains a single distribution nearly as it would be installed according to PEP 376 with a particular installation scheme. Although a specialized installer is recommended, a wheel file may be installed by simply unpacking into site-packages with the standard 'unzip' tool while preserving enough information to spread its contents out onto their final paths at any later time.</blockquote><p>To put it simply, wheels are a way to have your own local instant pypi.<h2 id=why-should-i-care>Why should I care</h2><p>I actually read a few articles on it some time ago but didn't see the usecase before actually using it myself.<p>Here are a few concrete examples on how you could possibly use them:<ul><li><strong>instant installation on localhost</strong>: having a global wheel directory where you can pull your libs from without going to pypi and doing so almost instantly, even for libs requiring compilation (lxml, pyscopg2, pillow, etc)<li><strong>deploying without needing pypi</strong>: obviously the compiled libs won't work if you are using different systems for developing and in production but the rest will work<li><strong>WAY faster installation of requirements</strong>: it takes only a few seconds to install, compared to a possibly long time depending on what you are using. Think of the time your builds on CI are taking just to install the requirements.<li>maybe deploy your project as a wheel? I haven't thought about it too much but that <em>should</em> be possible and you could change version using pip, the downside being that your project would be in the site-packages directory so it would be a bit annoying for management commands for django fo example</ul><p>I don't mind waiting a bit for my pip install but the deploy without pypi and the faster builds are killer features in my eyes.<h2 id=how-to-use-them>How to use them</h2><p>Let's imagine you have a project you want to convert to using wheels. You would have your dependencies in a requirements.txt (or several requirements file for different environments). The first thing you need to do is installing wheel.<pre class=language-bash data-lang=bash style=background:#0f1419;color:#bfbab0><code class=language-bash data-lang=bash><span style=color:#ffb454>$</span><span> pip install wheel </span><span style=font-style:italic;color:#5c6773># with pip version >= 1.4
</span></code></pre><p>At this point you remember that not even 10 lines above, I said we didn't use to use pypi to deploy. Wheels are zip archives that python can execute so that means we can actually use the wheel of wheel to install wheel (yo dawg, I heard you liked wheels). You could download the wheel manually and installing using whatever deployment system you are using but let's install from pip locally.<p>Now that you got pip and your requirements file ready, time to reinvent the wheels (haha...). For example, this is the result of running it in my <a href=https://github.com/Keats/django-drf-template>Django REST Framework template</a><pre class=language-bash data-lang=bash style=background:#0f1419;color:#bfbab0><code class=language-bash data-lang=bash><span style=color:#ffb454>$</span><span> pip wheel</span><span style=color:#f29718> --wheel-dir</span><span style=color:#f29668>=</span><span>wheelhouse/</span><span style=color:#f29718> -r</span><span> requirements/local.txt
</span></code></pre><p>A ls in wheelhouse gives me the following:<pre class=language-bash data-lang=bash style=background:#0f1419;color:#bfbab0><code class=language-bash data-lang=bash><span style=color:#ffb454>bcrypt-1.0.2-cp27-none-linux_x86_64.whl
</span><span style=color:#ffb454>docutils-0.11-py2-none-any.whl
</span><span style=color:#ffb454>pep8-1.5.6-py2.py3-none-any.whl
</span><span style=color:#ffb454>cffi-0.8.2-cp27-none-linux_x86_64.whl
</span><span style=color:#ffb454>flake8-2.1.0-py2-none-any.whl
</span><span style=color:#ffb454>psycopg2-2.5.3-cp27-none-linux_x86_64.whl
</span><span style=color:#ffb454>Django-1.7b4-py2.py3-none-any.whl
</span><span style=color:#ffb454>ipdb-0.8-py2-none-any.whl
</span><span style=color:#ffb454>pycparser-2.10-py2-none-any.whl
</span><span style=color:#ffb454>django_cors_headers-0.12-py2-none-any.whl
</span><span style=color:#ffb454>ipython-2.1.0-py2-none-any.whl
</span><span style=color:#ffb454>pyflakes-0.8.1-py2.py3-none-any.whl
</span><span style=color:#ffb454>django_debug_toolbar-1.2.1-py2.py3-none-any.whl
</span><span style=color:#ffb454>Jinja2-2.7.2-py2-none-any.whl
</span><span style=color:#ffb454>Pygments-1.6-py2-none-any.whl
</span><span style=color:#ffb454>django_extensions-1.3.7-py2.py3-none-any.whl
</span><span style=color:#ffb454>Markdown-2.4-py2-none-any.whl
</span><span style=color:#ffb454>six-1.6.1-py2.py3-none-any.whl
</span><span style=color:#ffb454>django_model_utils-2.0.3-py2.py3-none-any.whl
</span><span style=color:#ffb454>MarkupSafe-0.23-cp27-none-linux_x86_64.whl
</span><span style=color:#ffb454>Sphinx-1.2.2-py27-none-any.whl
</span><span style=color:#ffb454>djangorestframework-2.3.13-py2.py3-none-any.whl
</span><span style=color:#ffb454>mccabe-0.2.1-py2-none-any.whl
</span><span style=color:#ffb454>sqlparse-0.1.11-py2-none-any.whl
</span></code></pre><p>This shows pretty well the format of wheel filenames:<blockquote><p>{distribution}-{version}(-{build tag})?-{python tag}-{abi tag}-{platform tag}.whl</blockquote><p>The platform tag part is important, as a wheel compiled on mac will not work on an Ubuntu machine for example.<p>To install my requirements from my wheels, I simply need to tell pip where to look for:<pre class=language-bash data-lang=bash style=background:#0f1419;color:#bfbab0><code class=language-bash data-lang=bash><span style=color:#ffb454>$</span><span> pip install</span><span style=color:#f29718> --use-wheel --no-index --find-links</span><span style=color:#f29668>=</span><span>wheelhouse/</span><span style=color:#f29718> -r</span><span> requirements/local.txt
</span></code></pre><p>The <code>no-index</code> part flag ensures that pip won't try to look it up in others sources than the directory we specify in find-links. Delete your virtualenv and see how fast it is to install now (apparently wheel ignores URLs though, you could install the wheel file manually as explained above).<p>This is roughly the workflow with using wheels for your project.<p>Wheels definitely look like a win for every environment:<ul><li>dev: instant installation of most of your pip packages across your projects if you are using a shared wheel directory<li>ci: faster build and not reliant on pypi<li>prod: not reliant on pypi to deploy</ul></section></article></main></div>